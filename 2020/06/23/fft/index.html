<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.2/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"blog.macromogic.xyz","root":"/","images":"/images","scheme":"Muse","version":"8.2.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}};
  </script>
<meta name="description" content="算法复习笔记：多项式凭什么能FFT？ 写在前面 本文仅面向学习FFT算法的CS学生。文中关于傅里叶变换的阐述仅用于帮助快速简要地理解算法背后时域&#x2F;频域变换的意义，逻辑性不会像「信号与系统」课那么强。本人没系统学过「信号与系统」这门课，能写出这篇文章也要感谢来自FDU、SCUT的两位同学的帮助。欢迎各位大佬对本文内容进行指正！ 要系统学习「信号与系统」的内容，可参阅奥本海默著的《信号与系统》一书。">
<meta property="og:type" content="article">
<meta property="og:title" content="算法复习笔记：多项式凭什么能FFT？">
<meta property="og:url" content="https://blog.macromogic.xyz/2020/06/23/fft/index.html">
<meta property="og:site_name" content="Macromogic Blog">
<meta property="og:description" content="算法复习笔记：多项式凭什么能FFT？ 写在前面 本文仅面向学习FFT算法的CS学生。文中关于傅里叶变换的阐述仅用于帮助快速简要地理解算法背后时域&#x2F;频域变换的意义，逻辑性不会像「信号与系统」课那么强。本人没系统学过「信号与系统」这门课，能写出这篇文章也要感谢来自FDU、SCUT的两位同学的帮助。欢迎各位大佬对本文内容进行指正！ 要系统学习「信号与系统」的内容，可参阅奥本海默著的《信号与系统》一书。">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-06-23T12:23:19.000Z">
<meta property="article:modified_time" content="2021-02-05T15:28:25.949Z">
<meta property="article:author" content="T H">
<meta property="article:tag" content="Math">
<meta property="article:tag" content="Notes">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://blog.macromogic.xyz/2020/06/23/fft/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>
<title>算法复习笔记：多项式凭什么能FFT？ | Macromogic Blog</title>
  




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="Macromogic Blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Macromogic Blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AE%97%E6%B3%95%E5%A4%8D%E4%B9%A0%E7%AC%94%E8%AE%B0%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%87%AD%E4%BB%80%E4%B9%88%E8%83%BDfft"><span class="nav-number">1.</span> <span class="nav-text">算法复习笔记：多项式凭什么能FFT？</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2"><span class="nav-number">1.1.</span> <span class="nav-text">写在前面</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F"><span class="nav-number">1.2.</span> <span class="nav-text">多项式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%9A%84%E8%A1%A8%E7%A4%BA"><span class="nav-number">1.2.1.</span> <span class="nav-text">多项式的表示</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E7%9A%84%E8%AE%A1%E7%AE%97"><span class="nav-number">1.2.2.</span> <span class="nav-text">多项式的计算</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BF%A1%E5%8F%B7%E4%B8%8E%E7%B3%BB%E7%BB%9F%E9%80%9F%E8%A7%88"><span class="nav-number">1.3.</span> <span class="nav-text">“信号与系统”速览</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%B2%E6%BF%80%E5%87%BD%E6%95%B0%E5%92%8C%E7%BA%BF%E6%80%A7%E6%97%B6%E4%B8%8D%E5%8F%98%E7%B3%BB%E7%BB%9F"><span class="nav-number">1.3.1.</span> <span class="nav-text">冲激函数和线性时不变系统</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ltis%E5%9C%A8%E8%BF%9E%E7%BB%AD%E4%BF%A1%E5%8F%B7%E4%B8%8A%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="nav-number">1.3.2.</span> <span class="nav-text">LTIS在连续信号上的作用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ft%E7%9A%84%E6%8B%93%E5%B1%95dft%E4%B8%8E%E5%A4%9A%E9%A1%B9%E5%BC%8F%E8%A1%A8%E7%A4%BA"><span class="nav-number">1.3.3.</span> <span class="nav-text">FT的拓展：DFT与多项式表示</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E9%80%9F%E8%A7%88"><span class="nav-number">1.4.</span> <span class="nav-text">“线性代数”速览</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%8C%E5%88%97%E5%BC%8F%E5%BF%AB%E9%80%9F%E5%A4%8D%E4%B9%A0"><span class="nav-number">1.4.1.</span> <span class="nav-text">行列式快速复习</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8C%83%E7%89%B9%E8%92%99%E5%BE%B7%E7%9F%A9%E9%98%B5"><span class="nav-number">1.4.2.</span> <span class="nav-text">范特蒙德矩阵</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%82%B9%E5%80%BC%E8%A1%A8%E7%A4%BA%E6%B3%95%E7%9A%84%E6%B1%82%E5%80%BC"><span class="nav-number">1.4.3.</span> <span class="nav-text">“点值表示法”的求值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#idft%E7%9F%A9%E9%98%B5%E7%9A%84%E8%AE%A1%E7%AE%97"><span class="nav-number">1.4.4.</span> <span class="nav-text">IDFT矩阵的计算</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#fft%E5%A6%82%E4%BD%95%E6%8F%90%E9%80%9F"><span class="nav-number">1.5.</span> <span class="nav-text">FFT如何提速？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E6%A8%A1%E6%9D%BF"><span class="nav-number">1.6.</span> <span class="nav-text">代码模板</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%8E%E8%AE%B0"><span class="nav-number">1.7.</span> <span class="nav-text">后记</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">T H</p>
  <div class="site-description" itemprop="description">Nothing but dump.</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">14</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">10</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/macromgic" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;macromgic" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:tonyh0411@gmail.com" title="E-Mail → mailto:tonyh0411@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="fa fa-rss fa-fw"></i>RSS</a>
      </span>
  </div>


  <div class="links-of-blogroll site-overview-item animated">
    <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
      Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://blog.hackroid.com/" title="https:&#x2F;&#x2F;blog.hackroid.com" rel="noopener" target="_blank">Hackroid</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://blog.gogo.moe/" title="https:&#x2F;&#x2F;blog.gogo.moe" rel="noopener" target="_blank">Gogo</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://www.whexy.com/" title="https:&#x2F;&#x2F;www.whexy.com" rel="noopener" target="_blank">Whexy</a>
        </li>
    </ul>
  </div>

        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://blog.macromogic.xyz/2020/06/23/fft/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="T H">
      <meta itemprop="description" content="Nothing but dump.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Macromogic Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          算法复习笔记：多项式凭什么能FFT？
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2020-06-23 20:23:19" itemprop="dateCreated datePublished" datetime="2020-06-23T20:23:19+08:00">2020-06-23</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">Edited on</span>
        <time title="Modified: 2021-02-05 23:28:25" itemprop="dateModified" datetime="2021-02-05T23:28:25+08:00">2021-02-05</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Algorithm/" itemprop="url" rel="index"><span itemprop="name">Algorithm</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="算法复习笔记多项式凭什么能fft">算法复习笔记：多项式凭什么能FFT？</h1>
<h2 id="写在前面">写在前面</h2>
<p>本文仅面向学习FFT算法的<strong>CS学生</strong>。文中关于傅里叶变换的阐述仅用于帮助<strong>快速简要</strong>地理解算法背后时域/频域变换的意义，逻辑性不会像「信号与系统」课那么强。本人没系统学过「信号与系统」这门课，能写出这篇文章也要感谢来自FDU、SCUT的两位同学的帮助。欢迎各位大佬对本文内容进行指正！</p>
<p>要系统学习「信号与系统」的内容，可参阅<strong>奥本海默</strong>著的《信号与系统》一书。</p>
<p>在我学习FFT时，第一个面对的问题背景是<strong>「给定两个多项式，如何快速求得二者的乘积？」</strong>老师或者博客会先介绍<strong>多项式的系数表示和点值表示</strong>（在下一节也会再啰嗦一遍），然后引入<strong>单位根</strong>和<strong>分治</strong>思想来实现两种表示法间的转换。<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/31584464">这篇专栏</a>对算法内容及前置知识的讲解算是非常详尽的了，但它并没有解决一个问题：傅里叶变换的本质是将时域上的卷积转化成频域上的乘法，那么多项式的系数/点值表示为什么能和信号的时域/频域对应？本文将从<strong>偏向EE</strong>的角度来探讨这个算法，并尝试揭示其中的关联。</p>
<a id="more"></a>
<h2 id="多项式">多项式</h2>
<h3 id="多项式的表示">多项式的表示</h3>
<p>给定一个环<span class="math inline">\(\mathcal{R}\)</span>（通常是交换环）和一个未知数<span class="math inline">\(x\)</span>，则形如： <span class="math display">\[
p(x) = a_0 + a_1x + a_2x^2 + \dots + a_nx^n
\]</span> 的表达式称作<span class="math inline">\(\mathcal{R}\)</span>上的<strong>（一元）<span class="math inline">\(n\)</span>次多项式（Polynomial of order <span class="math inline">\(n\)</span>）</strong>（其中<span class="math inline">\(a_0, \dots, a_n \in \mathcal{R}\)</span>）。本文默认<span class="math inline">\(\mathcal{R} = \mathbb{C}\)</span>，但系数在<span class="math inline">\(\mathbb{R}\)</span>中取值。上述形式称作多项式<span class="math inline">\(p\)</span>的<strong>系数表示</strong>。</p>
<p>由<strong>代数基本定理</strong>，上述多项式在<span class="math inline">\(\mathbb{C}\)</span>上存在<span class="math inline">\(n\)</span>个根<span class="math inline">\(x_1, x_2, \dots, x_n\)</span>，则<span class="math inline">\(p\)</span>可写成以下形式： <span class="math display">\[
p(x) = A(x - x_1)(x - x_2)\dots(x - x_n)
\]</span> 取<span class="math inline">\(x_0 \notin \{x_1, \dots, x_n\}\)</span>，则<span class="math inline">\(A\)</span>的值可以唯一确定。一般地，一个<span class="math inline">\(n\)</span>次多项式可以由<span class="math inline">\(\mathcal{R}^2\)</span>上的<span class="math inline">\(n+1\)</span>个点<span class="math inline">\((x_0, y_0), \dots, (x_n, y_n)\)</span>唯一确定/表示。这种表示方法称作多项式<span class="math inline">\(p\)</span>的<strong>点值表示</strong>。</p>
<h3 id="多项式的计算">多项式的计算</h3>
<p>令： <span class="math display">\[
\begin{align*}p(x) &amp;= a_0 + a_1x + \dots + a_nx^n \\q(x) &amp;= b_0 + b_1x + \dots + b_nx^n\end{align*}
\]</span> 其点值表示为： <span class="math display">\[
\begin{align*}p(x) &amp;: (x_0, y_0), (x_1, y_1), \dots, (x_n, y_n) \\q(x) &amp;: (x_0, z_0), (x_1, z_1), \dots, (x_n, z_n)\end{align*}
\]</span> 其和为： <span class="math display">\[
(p+q)(x) = (a_0+b_0) + (a_1+b_1)x + \dots + (a_n+b_n)x^n \\(p+q)(x): (x_0, y_0+z_0), (x_1, y_1+z_1), \dots, (x_n, y_n+z_n)
\]</span> 积为： <span class="math display">\[
(pq)(x) = a_0b_0 + (a_0b_1+a_1b_0)x + \dots + \left(\sum_{0 \leq i \leq k}a_ib_{k-i}\right)x^k + \dots + a_nb_nx^{2n} \\(pq)(x): (x_0, y_0z_0), (x_1, y_1z_1), \dots, (x_n, y_nz_n), \dots, (x_{2n}, y_{2n}z_{2n})
\]</span> （注意做乘法时需要<span class="math inline">\(2n+1\)</span>个点，因为乘积次数为<span class="math inline">\(2n\)</span>）</p>
<p>对某一个值<span class="math inline">\(x\)</span>求值时： <span class="math display">\[
\begin{align*}p(x) &amp;= a_0 + a_1x + \dots + a_nx^n \\&amp;= a_0 + (a_1 + (a_2 + \dots(a_{n-1} + a_nx)x\dots)x)x \\p(x) &amp;= \sum_{k=0}^{n}\frac{\prod_{i \neq k} (x-x_i)}{\prod_{i \neq k} (x_k-x_i)}y_k\end{align*}
\]</span> 使用点值表示求值本质上是在解下面这个线性方程组（写成矩阵的形式）： <span class="math display">\[
\begin{bmatrix}y_0 \\ y_1 \\ \vdots \\ y_n\end{bmatrix}=\begin{bmatrix}1 &amp; x_0 &amp; \cdots &amp; x_0^n \\1 &amp; x_1 &amp; \cdots &amp; x_1^n \\\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\1 &amp; x_n &amp; \cdots &amp; x_n^n\end{bmatrix}\begin{bmatrix}a_0 \\ a_1 \\ \vdots \\ a_n\end{bmatrix}
\]</span> 然后求： <span class="math display">\[
\begin{align*}y &amp;= \begin{bmatrix}1 &amp; x &amp; \cdots &amp; x^n\end{bmatrix}\begin{bmatrix}a_0 \\ a_1 \\ \vdots \\ a_n\end{bmatrix} \\&amp;=\begin{bmatrix}1 &amp; x &amp; \cdots &amp; x^n\end{bmatrix}\begin{bmatrix}1 &amp; x_0 &amp; \cdots &amp; x_0^n \\1 &amp; x_1 &amp; \cdots &amp; x_1^n \\\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\1 &amp; x_n &amp; \cdots &amp; x_n^n\end{bmatrix}^{-1}\begin{bmatrix}y_0 \\ y_1 \\ \vdots \\ y_n\end{bmatrix}\end{align*}
\]</span> 关于该式的计算会在<strong>“线性代数”速览</strong>一节展开。</p>
<p>不难看出，两种表示方式在求积和求值上分别具有优势。其实这里的系数/点值转换和信号的时域/频域转换非常相似——两种表示法下的乘法过程可以和时域上的卷积、频域上的乘法对应起来。事实上在（我见过的）几乎所有的FFT博客/讲义都把这个过程叫做DFT/IDFT。下一节我将简要介绍<strong>傅里叶变换（Fourier Transformation，FT）</strong>的来由，以及<strong>离散傅里叶变换（Discrete Fourier Transformation，DFT）</strong>和多项式的联系。</p>
<h2 id="信号与系统速览">“信号与系统”速览</h2>
<p>这一部分实际上省略了大量铺垫内容，部分内容可能阐释不清，如有不明白的地方请参阅奥本海默并以书上内容为准。</p>
<h3 id="冲激函数和线性时不变系统">冲激函数和线性时不变系统</h3>
<p><strong>冲激函数</strong>（数学上常称为<strong>Dirac <span class="math inline">\(\delta\)</span>函数</strong>，下简称<strong><span class="math inline">\(\delta\)</span>函数</strong>）是定义在<span class="math inline">\(\mathbb{R}\)</span>上的一个广义函数。其满足：</p>
<ul>
<li><span class="math inline">\(\delta(x) \neq 0 \iff x = 0\)</span>；</li>
<li><span class="math inline">\(\int_{-\infty}^{+\infty}\delta(x)\mathrm{d}x = 1\)</span>。</li>
</ul>
<p>离散情形（可认为在<span class="math inline">\(\mathbb{Z}\)</span>上）下的<span class="math inline">\(\delta\)</span>函数可视作： <span class="math display">\[
\delta[x] = \begin{cases}1,&amp; x = 0 \\0,&amp; x \neq 0 \end{cases}
\]</span> <strong>线性时不变系统（Linear and Time Invariant System，LTIS）</strong>可视作某信号处理函数，顾名思义满足以下性质：</p>
<ul>
<li><strong>时不变性</strong>：输出不会随时间变化，若输入信号为平移后的<span class="math inline">\(x(t+t_0)\)</span>，则输出也为平移后的<span class="math inline">\(y(t+t_0)\)</span>；</li>
<li><strong>线性性</strong>：输入某些信号的线性组合<span class="math inline">\(\sum_k c_kx_k(t)\)</span>，输出也为对应结果的线性组合<span class="math inline">\(\sum_k c_ky_k(t)\)</span>。特别地，若输入为<span class="math inline">\(\int_{-\infty}^{+\infty}c_\omega x_\omega(t)\mathrm{d}\omega\)</span>，对应输出也为<span class="math inline">\(\int_{-\infty}^{+\infty}c_\omega y_\omega(t)\mathrm{d}\omega\)</span>。</li>
</ul>
<h3 id="ltis在连续信号上的作用">LTIS在连续信号上的作用</h3>
<p>观察到<span class="math inline">\(\delta\)</span>函数的性质，对任一连续信号<span class="math inline">\(f(t)\)</span>，其值可表示为： <span class="math display">\[
f(t) = \int_{-\infty}^{+\infty}f(\tau)\delta(t-\tau)\mathrm{d}\tau
\]</span> 将上式中<span class="math inline">\(f(\tau)\)</span>视为<span class="math inline">\(\delta(t - \tau)\)</span>的系数，则由LTIS的性质可知作用后的结果为： <span class="math display">\[
y(t) = \int_{-\infty}^{+\infty}f(\tau)h(t-\tau)\mathrm{d}\tau
\]</span> 其中<span class="math inline">\(h\)</span>是LTIS作用在<span class="math inline">\(\delta\)</span>上的结果。</p>
<p>下面观察<span class="math inline">\(f(t) = e^{j\omega t}\)</span>（其中<span class="math inline">\(j\)</span>为虚数单位，<span class="math inline">\(\omega\)</span>为频率，下同）的情形：</p>
<p>观察<span class="math inline">\(y(t)\)</span>的形式，不难发现这其实是一个<strong>卷积式</strong>，即<span class="math inline">\(y = f * h\)</span>，其中<span class="math inline">\(h\)</span>表征了作用在<span class="math inline">\(f\)</span>上的LTIS。由卷积式的对称性，上式可写成： <span class="math display">\[
\begin{align*}y(t) &amp;= \int_{-\infty}^{+\infty}e^{j\omega(t - \tau)}h(\tau)\mathrm{d}\tau \\&amp;= e^{j\omega t}\int_{-\infty}^{+\infty}e^{-j\omega\tau} h(\tau)\mathrm{d}\tau\end{align*}
\]</span> 记<span class="math inline">\(H(\omega) = \int_{-\infty}^{+\infty}e^{-j\omega\tau} h(\tau)\mathrm{d}\tau\)</span>，则上式可写作<span class="math inline">\(y(t) = f(t)H(\omega)\)</span>，即LTIS作用的结果仅为<span class="math inline">\(e^{j\omega t}\)</span>乘以一个关于<span class="math inline">\(\omega\)</span>的系数。</p>
<p>为什么要讨论这个函数形式？由欧拉公式<span class="math inline">\(e^{jx} = \cos x + j\sin x\)</span>知，复指数和周期函数有着天然的联系。由于复指数信号在LTIS中有上述优秀的性质，人们很自然地想把任意周期函数（信号）表示成一系列<span class="math inline">\(e^{j\omega_i t}\)</span>的线性组合（这也是一个粗糙的<strong>傅里叶级数</strong>的雏形）： <span class="math display">\[
f(t) = \sum_k A(\omega_k)e^{j\omega_k t}
\]</span> 事实上，非周期函数（信号）可以类似地以积分形式表示，可以认为非周期函数是周期趋近无穷大的周期函数： <span class="math display">\[
f(t) = \int_{-\infty}^{+\infty}A(\omega)e^{j\omega t}\mathrm{d}\omega \qquad (1)
\]</span> 对于表征LTIS的函数<span class="math inline">\(g(t)\)</span>，有： <span class="math display">\[
B(\omega) = \int_{-\infty}^{+\infty}e^{-j\omega \tau}g(\tau)\mathrm{d}\tau \qquad (2)
\]</span> 则二者卷积结果为： <span class="math display">\[
(f*g)(t) = \int_{-\infty}^{+\infty}A(\omega)B(\omega)e^{j\omega t}\mathrm{d}\omega \qquad (3)
\]</span> 不难看出，<span class="math inline">\(f(t)\)</span>和<span class="math inline">\(g(t)\)</span>是时域上的函数（以时间<span class="math inline">\(t\)</span>为自变量），而<span class="math inline">\(A(\omega)\)</span>和<span class="math inline">\(B(\omega)\)</span>是频域上的函数（以频率<span class="math inline">\(\omega\)</span>为自变量）。上面的<span class="math inline">\((1)\)</span>式和<span class="math inline">\((2)\)</span>式可以证明是互逆的操作（即<strong>傅里叶变换</strong>和<strong>逆傅里叶变换</strong>，证明参考Stein的《傅里叶分析导论》第五章）。由<span class="math inline">\((3)\)</span>式知，时域上的卷积和频域上的乘法等价。至此，我们应该对傅里叶级数和傅里叶变换有了非常粗浅简略的认识，下面来对傅里叶变换进行拓展。</p>
<h3 id="ft的拓展dft与多项式表示">FT的拓展：DFT与多项式表示</h3>
<p>下面提出时域函数和频域函数的两条特性，不作证明：</p>
<ul>
<li>时域的周期化对应频域的离散化；</li>
<li>时域的离散化对应频域的周期化。</li>
</ul>
<p>两条特性比较拗口，但是有高度的对称性。第一条特性比较好理解：时域上的周期函数可以用一系列成谐波关系的复指数函数<span class="math inline">\(f_k(t) = e^{jk\omega_0 t}\)</span>（<span class="math inline">\(k = 0, \pm1, \pm2, \dots\)</span>）的线性组合表示，表现在频域上则是离散的图像；第二条可以结合对称性和逆傅里叶变换理解。</p>
<p>根据这两个特性，下面我们直接拓展到<strong>离散傅里叶变换（Discrete Fourier Transformation，DFT）</strong>。DFT处理的是<strong>有限离散序列</strong>的卷积，该序列可以被认为是一个<strong>离散周期信号</strong>的主值序列（循环节）。变换后的序列也将是离散周期序列。</p>
<p>上面提到过<span class="math inline">\(\delta\)</span>函数在离散情形下的形式。由离散周期性，可以将无限求和等价写成有限求和的形式。令信号周期为<span class="math inline">\(N\)</span>，则可以类似地表示： <span class="math display">\[
f[t] = \sum_{k=0}^{N-1} f[k]\delta[t-k]
\]</span> 其中<span class="math inline">\(t = 0, 1, \dots, N-1\)</span>。LTIS的作用结果为： <span class="math display">\[
y[t] = \sum_{k=0}^{N-1} f[k]h[t-k]
\]</span> 上文提到过，周期信号可由一系列谐波函数叠加表示。下面讨论<span class="math inline">\(f[t] = e^{j\frac{2\pi i}{N}t}\)</span>的情形： <span class="math display">\[
\begin{align*}y[t] &amp;= \sum_{k=0}^{N-1} e^{j\frac{2\pi i}{N}(t-k)}h[k] \\&amp;= e^{j\frac{2\pi i}{N}t} \sum_{k=0}^{N-1} e^{-j\frac{2\pi i}{N}k}h[k]\end{align*}
\]</span> 令<span class="math inline">\(H[i] = \sum_{k=0}^{N-1} e^{-j\frac{2\pi i}{N}k}h[k]\)</span>，则<span class="math inline">\(y[t] = f[t]H[i]\)</span>。</p>
<p>由于<span class="math inline">\(e^{j\frac{2\pi i}{N}t}\)</span>在离散情形下只有<span class="math inline">\(N\)</span>个不同取值，一般的离散周期信号可以表示为： <span class="math display">\[
f[t] = \sum_{i=0}^{N-1}c_i  e^{j\frac{2\pi i}{N}t}
\]</span> 对<span class="math inline">\(f[t]\)</span>做DFT的结果为： <span class="math display">\[
A[i] = \sum_{t=0}^{N-1}f[t]e^{-j\frac{2\pi i}{N}t}
\]</span> 令<span class="math inline">\(\omega_i = e^{-j\frac{2\pi i}{N}t}\)</span>（其中<span class="math inline">\(i = 0, 1, \dots, N-1\)</span>），则DFT写成矩阵的形式为： <span class="math display">\[
\begin{bmatrix}A[0] \\ A[1] \\ \vdots \\ A[N-1]\end{bmatrix}=\begin{bmatrix}1 &amp; \omega_0 &amp; \cdots &amp; \omega_0^{N-1} \\1 &amp; \omega_1 &amp; \cdots &amp; \omega_1^{N-1} \\\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\1 &amp; \omega_{N-1} &amp; \cdots &amp; \omega_{N-1}^{N-1}\end{bmatrix}\begin{bmatrix}f[0] \\ f[1] \\ \vdots \\ f[N-1]\end{bmatrix}
\]</span> 因此IDFT的形式为： <span class="math display">\[
\begin{align*}\begin{bmatrix}f[0] \\ f[1] \\ \vdots \\ f[N-1]\end{bmatrix}&amp;=\begin{bmatrix}1 &amp; \omega_0 &amp; \cdots &amp; \omega_0^{N-1} \\1 &amp; \omega_1 &amp; \cdots &amp; \omega_1^{N-1} \\\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\1 &amp; \omega_{N-1} &amp; \cdots &amp; \omega_{N-1}^{N-1}\end{bmatrix}^{-1}\begin{bmatrix}A[0] \\ A[1] \\ \vdots \\ A[N-1]\end{bmatrix} \\&amp;= \frac{1}{N}\begin{bmatrix}1 &amp; \omega_0^{-1} &amp; \cdots &amp; \omega_0^{-(N-1)} \\1 &amp; \omega_1^{-1} &amp; \cdots &amp; \omega_1^{-(N-1)} \\\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\1 &amp; \omega_{N-1}^{-1} &amp; \cdots &amp; \omega_{N-1}^{-(N-1)}\end{bmatrix}\begin{bmatrix}A[0] \\ A[1] \\ \vdots \\ A[N-1]\end{bmatrix} \\\end{align*}
\]</span> 上式的<span class="math inline">\(\omega_i\)</span>实际就是<strong>单位根</strong>。关于该式的计算会在<strong>“线性代数”速览</strong>一节展开。</p>
<p>到这一步为止，我们可以揭示出多项式和离散周期信号的关系：将多项式的系数视作周期信号在时域上一个周期内的取值，则频域上的值就是该多项式在<span class="math inline">\(N\)</span>个单位根上的取值。这样一来，DFT和IDFT这两个词应用在多项式计算上也就不显生硬了。</p>
<p>光揭示了多项式和DFT的联系还不够，按上式进行变换的时间复杂度仍为<span class="math inline">\(O(N^2)\)</span>。下面我们先把遗留的矩阵计算问题啰嗦一下，再来讲FFT如何提高计算速度。</p>
<h2 id="线性代数速览">“线性代数”速览</h2>
<p>这一节只是对范特蒙德矩阵相关计算的解说，不感兴趣的话可以跳过。</p>
<h3 id="行列式快速复习">行列式快速复习</h3>
<p>对于<span class="math inline">\(\mathcal{R}\)</span>上的<span class="math inline">\(n \times n\)</span>方阵<span class="math inline">\(M = (m_{ij})\)</span>，令<span class="math inline">\(S_n\)</span>为<span class="math inline">\(\{1, 2, \dots, n\}\)</span>上的置换群，则<strong><span class="math inline">\(M\)</span>的行列式</strong>为： <span class="math display">\[
\det M = \sum_{\sigma \in S_n} \prod_{i=1}^n m_{i, \sigma(i)}
\]</span> 行列式有以下性质：</p>
<ul>
<li>转置矩阵的行列式和原矩阵相同；</li>
<li>矩阵某一行（列）乘以某个倍数，行列式乘以相同的倍数；</li>
<li>矩阵某一行（列）加上另一行（列）的某个倍数，行列式不变；</li>
<li>矩阵行列式非零当且仅当矩阵可逆。</li>
</ul>
<p>矩阵<span class="math inline">\(M\)</span>的<strong>伴随矩阵</strong>记作<span class="math inline">\(M^* = (M_{ij})^T\)</span>，其中<span class="math inline">\(M_{ij}\)</span>代表<span class="math inline">\(M\)</span>关于<span class="math inline">\(m_{ij}\)</span>的<strong>代数余子式</strong>（即去掉第<span class="math inline">\(i\)</span>行第<span class="math inline">\(j\)</span>列后矩阵的行列式乘以<span class="math inline">\((-1)^{i+j}\)</span>）。若<span class="math inline">\(M\)</span>可逆，则<span class="math inline">\(M^{-1} = \frac{1}{\det M}M^*\)</span>。</p>
<h3 id="范特蒙德矩阵">范特蒙德矩阵</h3>
<p><strong>范特蒙德（Vandermonde）矩阵</strong>指形如下面形式的矩阵（有时也指它的转置）： <span class="math display">\[
V = \begin{bmatrix}1 &amp; x_1 &amp; \cdots &amp; x_1^{n-1} \\1 &amp; x_2 &amp; \cdots &amp; x_2^{n-1} \\\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\1 &amp; x_n &amp; \cdots &amp; x_n^{n-1}\end{bmatrix}
\]</span> 不难看出，若存在<span class="math inline">\(i \neq j\)</span>使得<span class="math inline">\(x_i = x_j\)</span>，则<span class="math inline">\(\det V = 0\)</span>。</p>
<p><strong>定理</strong> 范特蒙德矩阵的行列式为<span class="math inline">\(\det V = \prod_{1 \leq i &lt; j \leq n}(x_j - x_i)\)</span>。</p>
<p><strong>证明</strong> 记<span class="math inline">\(V_1=V\)</span>，将<span class="math inline">\(V_1\)</span>从右向左每列依次减去左边一列的<span class="math inline">\(x_1\)</span>倍，则： <span class="math display">\[
V_1&#39; = \begin{bmatrix}1 &amp; 0 &amp; \cdots &amp; 0 \\1 &amp; x_2-x_1 &amp; \cdots &amp; x_2^{n-2}(x_2-x_1) \\\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\1 &amp; x_n-x_1 &amp; \cdots &amp; x_n^{n-2}(x_n-x_1)\end{bmatrix} \\
\]</span> 对第一行做拉普拉斯展开，则： <span class="math display">\[
\begin{align*}\det V &amp;= \det V_1 \\&amp;= \det V_1&#39; \\&amp;= \det \begin{bmatrix}x_2-x_1 &amp; \cdots &amp; x_2^{n-2}(x_2-x_1) \\\vdots &amp; \ddots &amp; \vdots \\x_n-x_1 &amp; \cdots &amp; x_n^{n-2}(x_n-x_1)\end{bmatrix} \\&amp;= \prod_{i=2}^n(x_i-x_1) \det \begin{bmatrix}1 &amp; \cdots &amp; x_2^{n-2} \\\vdots &amp; \ddots &amp; \vdots \\1 &amp; \cdots &amp; x_n^{n-2}\end{bmatrix} \end{align*}
\]</span> 记<span class="math inline">\(V_2\)</span>为上面最后一步得到的矩阵，类似地有： <span class="math display">\[
\det V_2 = \prod_{i=3}^n (x_i-x_2)\det V_3
\]</span> 依次类推，行列式得证。</p>
<h3 id="点值表示法的求值">“点值表示法”的求值</h3>
<p>令： <span class="math display">\[
X = \begin{bmatrix}1 &amp; x_0 &amp; \cdots &amp; x_0^n \\1 &amp; x_1 &amp; \cdots &amp; x_1^n \\\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\1 &amp; x_n &amp; \cdots &amp; x_n^n\end{bmatrix}
\]</span> 下面计算该式： <span class="math display">\[
y = \begin{bmatrix}1 &amp; x &amp; \cdots &amp; x^n\end{bmatrix}X^{-1}\begin{bmatrix}y_0 \\ y_1 \\ \vdots \\ y_n\end{bmatrix}
\]</span> 讨论<span class="math inline">\(y_k\)</span>的系数，由拉普拉斯展开式的形式，有： <span class="math display">\[
\begin{align*}\frac{1}{\prod_{0 \leq i &lt; j \leq n}(x_j - x_i)}\begin{bmatrix}1 &amp; x &amp; \cdots &amp; x^n\end{bmatrix}\begin{bmatrix}X_{k0} \\ X_{k1} \\ \vdots \\ X_{kn}\end{bmatrix}&amp;=\frac{1}{\prod_{0 \leq i &lt; j \leq n}(x_j - x_i)}\det\begin{bmatrix}1 &amp; x_0 &amp; \cdots &amp; x_0^n \\\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\1 &amp; x &amp; \cdots &amp; x^n \\\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\1 &amp; x_n &amp; \cdots &amp; x_n^n\end{bmatrix} \\&amp;= \frac{\prod_{0 \leq i &lt; j \leq n, i \neq k, j \neq k}(x_j-x_i)\prod_{0 \leq i &lt; k}(x-x_i)\prod_{k &lt; j \leq n}(x_j-x)}{\prod_{0 \leq i &lt; j \leq n}(x_j - x_i)} \\&amp;= \frac{\prod_{i \neq k} (x-x_i)}{\prod_{i \neq k} (x_k-x_i)}\end{align*}
\]</span></p>
<h3 id="idft矩阵的计算">IDFT矩阵的计算</h3>
<p>DFT矩阵为： <span class="math display">\[
F = \begin{bmatrix}1 &amp; \omega_0 &amp; \cdots &amp; \omega_0^{N-1} \\1 &amp; \omega_1 &amp; \cdots &amp; \omega_1^{N-1} \\\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\1 &amp; \omega_{N-1} &amp; \cdots &amp; \omega_{N-1}^{N-1}\end{bmatrix}
\]</span> <span class="math inline">\(F^{-1}\)</span>也可用上述方法暴力计算，但观察到<span class="math inline">\(\frac{1}{\sqrt{N}}F\)</span>是厄米（Hermitian）矩阵，即<span class="math inline">\(\frac{1}{N}F\bar{F}^T = I\)</span>，其中<span class="math inline">\(\bar{F}\)</span>表示<span class="math inline">\(F\)</span>的元素取共轭复数的结果，很自然地就有： <span class="math display">\[
F^{-1} = \frac{1}{N}\bar{F}
\]</span></p>
<h2 id="fft如何提速">FFT如何提速？</h2>
<p>下面介绍<strong>快速傅里叶变换（Fast Fourier Transformation，FFT）</strong>的核心思路。</p>
<p>FFT的提速得益于<strong>分治</strong>的思想。考虑下列<span class="math inline">\(n\)</span>次多项式（<span class="math inline">\(n\)</span>为奇数）： <span class="math display">\[
p(x) = a_0 + a_1x + \dots + a_{n-1}x^{n-1}a_nx^n
\]</span> 将<span class="math inline">\(p\)</span>的系数按奇偶次项分开，构造下列多项式： <span class="math display">\[
\begin{align*}p_0(x) &amp;= a_0 + a_2x + \dots + a_{n-1}x^{\frac{n-1}{2}} \\p_1(x) &amp;= a_1 + a_3x + \dots + a_{n}x^{\frac{n-1}{2}}\end{align*}
\]</span> 则有： <span class="math display">\[
\begin{align*}p(x) &amp;= p_0(x^2) + p_1(x^2) \cdot x \\p(-x) &amp;= p_0(x^2) - p_1(x^2) \cdot x\end{align*}
\]</span> 这样可将多项式的计算拆分成两个长度为原来一半的多项式的计算。为保证每次恰好能将多项式分成长度相等的两个多项式，可以将原多项式补全成<span class="math inline">\(2^k-1\)</span>次（<span class="math inline">\(k\)</span>为某个正整数），高次项系数补0。</p>
<p>接下来探讨单位复根的使用：</p>
<p>记<span class="math inline">\(\omega_n^k = e^{j\frac{2\pi k}{n}}\)</span>，则有<span class="math inline">\(\omega_n^k= \omega_{2n}^{2k} = (\omega_{2n}^{k})^2\)</span>，<span class="math inline">\(-\omega_n^k = \omega_n^{k+n/2}\)</span>，证明略。</p>
<p>代入上式则有： <span class="math display">\[
\begin{align*}p(\omega_n^k) &amp;= p_0(\omega_{n/2}^k) + p_1(\omega_{n/2}^k) \cdot \omega_n^k \\p(\omega_n^{k+n/2}) &amp;= p_0(\omega_{n/2}^k) - p_1(\omega_{n/2}^k) \cdot \omega_n^k\end{align*}
\]</span> 取<span class="math inline">\(k = 0, 1, 2, \dots, \frac{n}{2} - 1\)</span>，则可以通过拆分后的式子计算原多项式的值，总时间复杂度降为<span class="math inline">\(O(n \log n)\)</span>。</p>
<p>IDFT的过程和DFT基本一致，只有细节上的差距，这里略去，详情可见下面的代码模板。</p>
<p>至此，在多项式乘法中应用DFT/IDFT才真正具有意义：傅里叶变换不是无用功，它能帮助显著缩短计算时间。</p>
<h2 id="代码模板">代码模板</h2>
<p>实现细节这里不再赘述，请参考<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/31584464">这篇专栏</a>或搜索Cooley-Tukey算法（其中使用了一些位运算技巧来减小分治的空间开销）。实际使用中调用带<code>template</code>的两个函数即可。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;complex&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> fft &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">complex</span>&lt;<span class="keyword">double</span>&gt; cd;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> MAXL = <span class="number">3600180</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">double</span> PI = <span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br><span class="line"></span><br><span class="line">cd a[MAXL], b[MAXL];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> rev[MAXL];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">get_rev</span><span class="params">(<span class="keyword">int</span> bit)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="number">1</span> &lt;&lt; bit); i++) &#123;</span><br><span class="line">        rev[i] = (rev[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (bit - <span class="number">1</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">fft</span><span class="params">(cd* a, <span class="keyword">int</span> n, <span class="keyword">int</span> dft)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &lt; rev[i]) &#123;</span><br><span class="line">            swap(a[i], a[rev[i]]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> step = <span class="number">1</span>; step &lt; n; step &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">        cd omega = <span class="built_in">exp</span>(cd(<span class="number">0</span>, dft * PI / step));</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; n; j += (step &lt;&lt; <span class="number">1</span>)) &#123;</span><br><span class="line">            <span class="function">cd <span class="title">omk</span><span class="params">(<span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = j; k &lt; j + step; k++) &#123;</span><br><span class="line">                cd x = a[k];</span><br><span class="line">                cd y = omk * a[k + step];</span><br><span class="line">                a[k] = x + y;</span><br><span class="line">                a[k + step] = x - y;</span><br><span class="line">                omk *= omega;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (dft == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">            a[i] /= n;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(a, <span class="number">0</span>, <span class="keyword">sizeof</span>(a));</span><br><span class="line">    <span class="built_in">memset</span>(b, <span class="number">0</span>, <span class="keyword">sizeof</span>(b));</span><br><span class="line">    <span class="built_in">memset</span>(rev, <span class="number">0</span>, <span class="keyword">sizeof</span>(rev));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">get_conv</span><span class="params">(T* arr1, <span class="keyword">int</span> len1, T* arr2, <span class="keyword">int</span> len2)</span> </span>&#123;</span><br><span class="line">    init();</span><br><span class="line">    <span class="keyword">int</span> bit = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> ((<span class="number">1</span> &lt;&lt; bit) &lt; len1 + len2 - <span class="number">1</span>) bit++;</span><br><span class="line">    <span class="keyword">int</span> s = <span class="number">1</span> &lt;&lt; bit;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len1; i++) &#123;</span><br><span class="line">        a[i] = <span class="keyword">double</span>(arr1[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len2; i++) &#123;</span><br><span class="line">        b[i] = <span class="keyword">double</span>(arr2[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    get_rev(bit);</span><br><span class="line">    fft(a, s, <span class="number">1</span>);</span><br><span class="line">    fft(b, s, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s; i++) &#123;</span><br><span class="line">        a[i] *= b[i];</span><br><span class="line">    &#125;</span><br><span class="line">    fft(a, s, <span class="number">-1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">get_ans</span><span class="params">(T* ans, <span class="keyword">int</span> st, <span class="keyword">int</span> ed)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = st; i &lt; ed; i++) &#123;</span><br><span class="line">        ans[i - st] = T(a[i].real() + <span class="number">0.5</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;  <span class="comment">// namespace fft</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="后记">后记</h2>
<p>以上内容为一个学了一年FFT没学明白的蒟蒻试图在一个下午之内参透FT的含义的产物。其中有很多内容可能存在疏漏，如果有更加准确却不失简洁性的解释，欢迎联系指正。</p>
<p><del>不过估计也不会有人会像我一样钻牛角尖钻出这么个四不像吧？</del></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="followme">
  <span>Welcome to my other publishing channels</span>

  <div class="social-list">

      <div class="social-item">
        <a target="_blank" class="social-link" href="/atom.xml">
          <span class="icon">
            <i class="fa fa-rss"></i>
          </span>

          <span class="label">RSS</span>
        </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/Math/" rel="tag"># Math</a>
              <a href="/tags/Notes/" rel="tag"># Notes</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2020/06/15/ff-cache/" rel="prev" title="算法复习笔记：贪心求最优Caching策略">
                  <i class="fa fa-chevron-left"></i> 算法复习笔记：贪心求最优Caching策略
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2020/08/11/max-flow/" rel="next" title="算法复习笔记：网络流">
                  算法复习笔记：网络流 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>







<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">T H</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  






  




  <script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'none'
      },
      options: {
        renderActions: {
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              const target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js';
    script.defer = true;
    document.head.appendChild(script);
  } else {
    MathJax.startup.document.state(0);
    MathJax.typesetClear();
    MathJax.texReset();
    MathJax.typeset();
  }
</script>



</body>
</html>
